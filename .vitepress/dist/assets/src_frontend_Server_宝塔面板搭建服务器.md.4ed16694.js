import{o as n,c as a,d as s}from"./app.ca2be113.js";const t='{"title":"宝塔面板搭建服务器","description":"","frontmatter":{},"headers":[{"level":2,"title":"一、下载软件","slug":"一、下载软件"},{"level":2,"title":"二、上传网站","slug":"二、上传网站"},{"level":2,"title":"三、连接数据库","slug":"三、连接数据库"},{"level":2,"title":"四、本地连接mongodb","slug":"四、本地连接mongodb"},{"level":2,"title":"五、上传基于node的网站","slug":"五、上传基于node的网站"},{"level":2,"title":"六、配置nginx反向代理","slug":"六、配置nginx反向代理"},{"level":2,"title":"七、nginx常用配置","slug":"七、nginx常用配置"},{"level":2,"title":"八、配置https","slug":"八、配置https"},{"level":2,"title":"九、添加网站","slug":"九、添加网站"}],"relativePath":"src/frontend/Server/宝塔面板搭建服务器.md","lastUpdated":1615699077415}',e={},p=s('<h1 id="宝塔面板搭建服务器"><a class="header-anchor" href="#宝塔面板搭建服务器" aria-hidden="true">#</a> 宝塔面板搭建服务器</h1><h2 id="一、下载软件"><a class="header-anchor" href="#一、下载软件" aria-hidden="true">#</a> 一、下载软件</h2><p>putty | xshell：连接远程linux服务器</p><p>winscp | FileZilla： 连接ftp的；</p><p>安装宝塔面板：<a href="https://www.bt.cn/bbs/thread-19376-1-1.html" target="_blank" rel="noopener noreferrer">https://www.bt.cn/bbs/thread-19376-1-1.html</a></p><p>宝塔面板功能：直接在linux系统里面输入bt，会打开菜单，选择对应的指令即可；</p><h2 id="二、上传网站"><a class="header-anchor" href="#二、上传网站" aria-hidden="true">#</a> 二、上传网站</h2><ol><li>将vue进行打包操作，并压缩，格式需要是zip的格式；</li><li>添加站点，将域名添加为站点，之后点击进入目录，</li></ol><p><img src="https://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-01.png" alt="image"></p><ol start="3"><li>进入文件目录之后，将压缩好的文件上传并解压，之后就可以访问了；</li></ol><h2 id="三、连接数据库"><a class="header-anchor" href="#三、连接数据库" aria-hidden="true">#</a> 三、连接数据库</h2><ol><li>安装好宝塔面板之后，安装mongodb和pm2</li></ol><p><img src="https://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-02.png" alt="image"></p><ol start="2"><li>在linux系统里面输入mongo，管理mongodb数据库；可以直接通过本地连接进行</li><li>将json文件数据库传入服务器（直接将文件上传上面是不能访问的），之后在linux系统里面使用mongo import将数据库导入，并使用db.collections.find()查询一下，如果有数据，则上传成功了；</li></ol><h2 id="四、本地连接mongodb"><a class="header-anchor" href="#四、本地连接mongodb" aria-hidden="true">#</a> 四、本地连接mongodb</h2><ol><li>在宝塔面板将mongodb的端口放开，并在安全里面放行27017端口，在服务器后台也放行端口；</li></ol><p><img src="https://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-03.png" alt="image"></p><p><img src="https://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-04.png" alt="image"></p><ol start="2"><li>在图形化mongodb软件里面，新建连接并将原有的localhost删除，否则不能连接；</li></ol><p><img src="https://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-05.png" alt="image"></p><h2 id="五、上传基于node的网站"><a class="header-anchor" href="#五、上传基于node的网站" aria-hidden="true">#</a> 五、上传基于node的网站</h2><ol><li>将node的文件夹进行压缩（不要删除node_modules），之后将压缩包上传到宝塔面板上，之后解压；</li><li>安装pm2管理器，并打开pm2管理器</li></ol><p><img src="https://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-06.png" alt="image"></p><ol start="3"><li>点击文件夹，选中上传的node，并输入启动文件名，输入项目名称；</li><li>添加成功之后点击映射，映射到域名上（域名需要在域名解析添加）；</li></ol><h2 id="六、配置nginx反向代理"><a class="header-anchor" href="#六、配置nginx反向代理" aria-hidden="true">#</a> 六、配置nginx反向代理</h2><p>注意api必须加上，检查api的地方，修改之后记得重启nginx服务器；</p><div class="language-bash"><pre><code>    location /api <span class="token punctuation">{</span>\n        rewrite ^.+api/?<span class="token punctuation">(</span>.*<span class="token punctuation">)</span>$ /<span class="token variable">$1</span> <span class="token builtin class-name">break</span><span class="token punctuation">;</span>\n        proxy_pass http://39.107.127.240:3000<span class="token punctuation">;</span>\n        <span class="token comment"># 作用和proxyTable差不多  上传时记得删除这句话</span>\n    <span class="token punctuation">}</span>\n</code></pre></div><p><img src="https://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-07.png" alt="image"></p><h2 id="七、nginx常用配置"><a class="header-anchor" href="#七、nginx常用配置" aria-hidden="true">#</a> 七、nginx常用配置</h2><div class="language-bash"><pre><code>server <span class="token punctuation">{</span>\n    listen <span class="token number">80</span><span class="token punctuation">;</span>\n    server_name wyy.heny.vip<span class="token punctuation">;</span>\n\n    <span class="token comment"># 避免非root路径404</span>\n    location / <span class="token punctuation">{</span>\n        try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment"># 解决跨域</span>\n    location /api <span class="token punctuation">{</span>\n        proxy_pass http://wyy.heny.vip<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment"># 为带hash值的文件配置永久缓存</span>\n    location ~* <span class="token punctuation">\\</span>.<span class="token punctuation">(</span>?:css<span class="token operator">|</span>js<span class="token punctuation">)</span>$ <span class="token punctuation">{</span>\n        try_files <span class="token variable">$uri</span> <span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">;</span>\n        expires 1y<span class="token punctuation">;</span>\n        add_header Cache-Control <span class="token string">&quot;public&quot;</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    location ~ ^.+<span class="token punctuation">\\</span><span class="token punctuation">..</span>+$ <span class="token punctuation">{</span>\n        try_files <span class="token variable">$uri</span> <span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><ol start="2"><li>解决socket中nginx转发问题：</li></ol><div class="language-bash"><pre><code>server <span class="token punctuation">{</span>\n    listen       <span class="token number">80</span><span class="token punctuation">;</span>\n    server_name  school.godotdotdot.com<span class="token punctuation">;</span>\n    charset utf-8<span class="token punctuation">;</span>\n\n    location ~ / <span class="token punctuation">{</span>\n        proxy_pass http://127.0.0.1:3000<span class="token punctuation">;</span>\n        proxy_set_header Host <span class="token variable">$host</span><span class="token punctuation">;</span>\n        proxy_http_version <span class="token number">1.1</span><span class="token punctuation">;</span>\n        proxy_set_header Upgrade <span class="token variable">$http_upgrade</span><span class="token punctuation">;</span>\n        proxy_set_header Connection <span class="token string">&quot;upgrade&quot;</span><span class="token punctuation">;</span>\n        proxy_set_header X-Real-IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>\n        proxy_set_header X-Forwarded-For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>\n        proxy_connect_timeout <span class="token number">60</span><span class="token punctuation">;</span>\n        proxy_read_timeout <span class="token number">600</span><span class="token punctuation">;</span>\n        proxy_send_timeout <span class="token number">600</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    error_page   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html<span class="token punctuation">;</span>\n    location <span class="token operator">=</span> /50x.html <span class="token punctuation">{</span>\n        root   html<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p>nginx：try_file常用配置：<a href="https://www.hi-linux.com/posts/53878.html" target="_blank" rel="noopener noreferrer">https://www.hi-linux.com/posts/53878.html</a></p><p>总结笔记：<a href="http://jsanntq.cn/2020/04/07/Nginx/" target="_blank" rel="noopener noreferrer">http://jsanntq.cn/2020/04/07/Nginx/</a></p><h2 id="八、配置https"><a class="header-anchor" href="#八、配置https" aria-hidden="true">#</a> 八、配置https</h2><ol><li>到阿云搜索ssl，之后云开通ssl，免费型的可以使用https一个二级域名；</li><li>配置了https的域名，域名头部访问就不再是一个不安全的标示了；</li></ol><p><img src="https://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-08.png" alt="image"></p><p><img src="https://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-09.png" alt="image"></p><p><img src="https://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-10.png" alt="image"></p><ol start="2"><li>进入ssl控制台，进行下载文件，下载nginx的，绑定的域名如果需要更换可以进行吊销，之后重新购买；</li></ol><p><img src="https://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-11.png" alt="image"></p><ol start="3"><li>打开宝塔面板，将下载好的key和pem代码复制进去；</li></ol><p><img src="https://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-12.png" alt="image"></p><h2 id="九、添加网站"><a class="header-anchor" href="#九、添加网站" aria-hidden="true">#</a> 九、添加网站</h2><ol><li>在宝塔面板配置之后，还得在域名解析上面解析一个二级域名</li></ol>',45);e.render=function(s,t,e,o,l,i){return n(),a("div",null,[p])};export default e;export{t as __pageData};
