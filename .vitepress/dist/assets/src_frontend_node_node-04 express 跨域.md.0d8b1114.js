import{o as n,c as s,d as a}from"./app.0bfd9210.js";const p='{"title":"node-04 express 跨域","description":"","frontmatter":{},"headers":[{"level":2,"title":"一、第三方包 express","slug":"一、第三方包-express"},{"level":2,"title":"二、url参数","slug":"二、url参数"},{"level":3,"title":"传参","slug":"传参"},{"level":3,"title":"接收参数：","slug":"接收参数："},{"level":3,"title":"使用 URLSearchParams接口","slug":"使用-urlsearchparams接口"},{"level":2,"title":"三、路由","slug":"三、路由"},{"level":2,"title":"四、路由模块化","slug":"四、路由模块化"},{"level":2,"title":"五、express跨域问题","slug":"五、express跨域问题"},{"level":2,"title":"六、接收前端传入的数据post","slug":"六、接收前端传入的数据post"},{"level":2,"title":"七、node修改自动重启  热更新","slug":"七、node修改自动重启-热更新"},{"level":2,"title":"八、使用脚手架快速生成express框架","slug":"八、使用脚手架快速生成express框架"},{"level":2,"title":"九、javascript运行机制","slug":"九、javascript运行机制"}],"relativePath":"src/frontend/node/node-04 express 跨域.md","lastUpdated":1615699077471}',t={},o=a('<h1 id="node-04-express-跨域"><a class="header-anchor" href="#node-04-express-跨域" aria-hidden="true">#</a> node-04 express 跨域</h1><h2 id="一、第三方包-express"><a class="header-anchor" href="#一、第三方包-express" aria-hidden="true">#</a> 一、第三方包 express</h2><p>下载官网： <a href="http://www.expressjs.com.cn" target="_blank" rel="noopener noreferrer">http://www.expressjs.com.cn</a></p><p>安装：<code>npm i express</code>；</p><p>安装之后：npm init -y 建立package.json；</p><ol><li>创建一个服务器；</li></ol><div class="language-js"><pre><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span>   <span class="token comment">// 引入</span>\n<span class="token keyword">let</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">// 使用</span>\napp<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span>   <span class="token comment">// 监听</span>\napp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>   <span class="token comment">//设置路由</span>\n</code></pre></div><ol start="2"><li><p>请求方式可以使用get,post,put,delete......；</p><p>app.all：代表全部路由，一般写在页面最底部，用来响应404的；</p><p>当多个相同的路径不同的请求方式时，找到一个则不找下一个；</p></li></ol><div class="language-js"><pre><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\napp<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;监听成功...&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\napp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&#39;哈哈&#39;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre></div><h2 id="二、url参数"><a class="header-anchor" href="#二、url参数" aria-hidden="true">#</a> 二、url参数</h2><h3 id="传参"><a class="header-anchor" href="#传参" aria-hidden="true">#</a> 传参</h3><ul><li>get传参时，通过?后面传参；</li><li>post传参点击postman软件的params添加；</li></ul><h3 id="接收参数："><a class="header-anchor" href="#接收参数：" aria-hidden="true">#</a> 接收参数：</h3><ul><li>查询字符串接收使用req.query；</li><li>path路径使用req.params；</li></ul><p>path路径是伪静态，对网络蜘蛛有优化，写地址需要带动态的，需要冒号写:name；</p><p>:nid/:page，接收之后是{nid:123,page:11}；</p><h3 id="使用-urlsearchparams接口"><a class="header-anchor" href="#使用-urlsearchparams接口" aria-hidden="true">#</a> 使用 URLSearchParams接口</h3><div class="language-js"><pre><code><span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre></div><ul><li>获取单个字段：<code>query.get(key)</code>; 括号获取具体的名；</li><li>查询：<code>query.has(key)</code>；判断是否存在；</li><li>添加字段：<code>query.append(key,value)</code>；</li><li>删除：<code>query.delete(key)</code>；</li><li>修改：<code>query.set(key,value)</code>；</li><li>转回去：<code>query.toString()</code>；转回路由；</li></ul><p><code>urlsearchParams</code>配合<code>Object.fromEntries()</code>；将假对象转换为真对象；</p><div class="language-js"><pre><code>Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token string">&#39;foo=bar&amp;baz=qux&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token comment">// { foo: &quot;bar&quot;, baz: &quot;qux&quot; }</span>\n</code></pre></div><h2 id="三、路由"><a class="header-anchor" href="#三、路由" aria-hidden="true">#</a> 三、路由</h2><ol><li><p>设计路由</p><ul><li>请求方式：get、post、put、delete.....</li><li>根据path（请求地址）不同，返回不同的响应；</li></ul></li><li><p>url地址还可以写正则表达式，</p></li><li><p><code>res.send()</code>：括号填写需要显示的内容，能根据返回的内容自动识别返回的类型（不需要设置头信息就可以显示）；</p><p>里面也可以存放script标签，这样可以向前台传输alert和location跳转页面；</p></li><li><p><code>res.sendFile(path)</code>；开放静态页面；需要填写绝对路径</p><div class="language-js"><pre><code>res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>\n</code></pre></div></li><li><p>所有路由都是从&#39;/&#39;根开始的；</p></li><li><p><code>app.method(path,callback)</code>；获取响应方式；</p></li></ol><h2 id="四、路由模块化"><a class="header-anchor" href="#四、路由模块化" aria-hidden="true">#</a> 四、路由模块化</h2><p>作用：将路由地址的部分单独拧出来；</p><ol><li><p>创建/routers/users.js</p><div class="language-js"><pre><code><span class="token comment">//* /router/users.js</span>\n<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span> \n<span class="token keyword">const</span> routers <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">// 创建模块化</span>\nrouters<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/list&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span> \nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> router\n</code></pre></div></li><li><p>修改app.js</p><div class="language-js"><pre><code><span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./router/users.js&#39;</span><span class="token punctuation">)</span>\napp<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;/api/users&#39;</span><span class="token punctuation">,</span> routes<span class="token punctuation">)</span>\n</code></pre></div></li></ol><p>之后users.js文件夹下面的所有api访问都需要添加/api/users的前缀了；</p><h2 id="五、express跨域问题"><a class="header-anchor" href="#五、express跨域问题" aria-hidden="true">#</a> 五、express跨域问题</h2><ol><li>将以下内容加到路由下面的头信息，设置之后不需要跨域了；cors解决的；</li></ol><div class="language-js"><pre><code><span class="token comment">// 允许哪个源可以访问</span>\nres<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Allow-Origin&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// 允许携带那个头访问</span>\nres<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Allow-Headers&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Content-Type,Content-Length, Authorization, Accept, X-Requested-With , yourHeaderFeild&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// 允许哪个请求方法访问</span>\nres<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Allow-Methods&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;PUT, POST, GET, DELETE,OPTIONS&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// 允许携带cookie  当origin设置*之后，不允许设置该选项</span>\nres<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Allow-Credentials&#39;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>\n<span class="token comment">// 预检的存活时间</span>\nres<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Max-Age&#39;</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>\n<span class="token comment">// 允许前端获取哪个头信息</span>\nres<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Expose-Headers&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span>\n</code></pre></div><ol start="2"><li>使用中间件给所有请求添加请求头</li></ol><div class="language-js"><pre><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res<span class="token punctuation">,</span>next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 这里可以直接拿origin：req.headers.origin</span>\n    <span class="token comment">// 也可以直接判断origin是否在白名单，才进行往下面走</span>\n    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Allow-Origin&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Allow-Headers&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Content-Type,Content-Length, Authorization, Accept, X-Requested-With , yourHeaderFeild&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Allow-Methods&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;PUT, POST, GET, DELETE,OPTIONS&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre></div><ol start="2"><li>查看ajax完整的错误信息</li></ol><div class="language-js"><pre><code><span class="token function-variable function">error</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">XMLHttpRequest<span class="token punctuation">,</span> textStatus<span class="token punctuation">,</span> errorThrown</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>XMLHttpRequest<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>XMLHttpRequest<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>XMLHttpRequest<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>textStatus<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// parser error;</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p>put、post等等请求会发送options请求进行跨域检测，当允许跨域时才会发送请求，此时可以在node中间件中进行设置：</p><div class="language-js"><pre><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Allow-Origin&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">)</span>\n    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Allow-Headers&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Content-Type,Content-Length, Authorization, Accept, X-Requested-With , yourHeaderFeild&#39;</span><span class="token punctuation">)</span>\n    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Allow-Methods&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;PUT, POST, GET, DELETE,OPTIONS&#39;</span><span class="token punctuation">)</span>\n    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Max-Age&#39;</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token comment">// 6秒不重新发送options</span>\n    <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">&#39;OPTIONS&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// OPTIONS请求不做任何处理</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre></div><h2 id="六、接收前端传入的数据post"><a class="header-anchor" href="#六、接收前端传入的数据post" aria-hidden="true">#</a> 六、接收前端传入的数据post</h2><ol><li><p>下载第三方npm包(body-parser)；</p></li><li><p>引入模块</p></li></ol><div class="language-js"><pre><code><span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;body-parser&#39;</span><span class="token punctuation">)</span>\n</code></pre></div><ol start="3"><li>加载json中间键</li></ol><div class="language-js"><pre><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n</code></pre></div><ol start="4"><li>加载解析urlencoded请求体的中间件。</li></ol><div class="language-js"><pre><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span>extended<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre></div><ol start="5"><li>req.body，显示传入的data数据；</li></ol><p>使用postman测试接口：点击params---body----x-www-form-urlencoded；</p><h2 id="七、node修改自动重启-热更新"><a class="header-anchor" href="#七、node修改自动重启-热更新" aria-hidden="true">#</a> 七、node修改自动重启 热更新</h2><ol><li>全局安装：<code>npm i -g nodemon</code></li><li>在项目根目录（和服务入口文件同级）创建一个文件<code>nodemon.json</code>并写入（为了配置，如果不需要则不用配置），之后启动项目需要<code>nodemon index.js</code>启动</li></ol><div class="language-json"><pre><code><span class="token punctuation">{</span>\n    <span class="token property">&quot;restartable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rs&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;ignore&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token string">&quot;.git&quot;</span><span class="token punctuation">,</span>\n        <span class="token string">&quot;.svn&quot;</span><span class="token punctuation">,</span>\n        <span class="token string">&quot;node_modules/**/node_modules&quot;</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;verbose&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;execMap&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token property">&quot;js&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node --harmony&quot;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;watch&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;env&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token property">&quot;NODE_ENV&quot;</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;ext&quot;</span><span class="token operator">:</span> <span class="token string">&quot;js json&quot;</span>\n<span class="token punctuation">}</span>\n</code></pre></div><ol start="3"><li>修改入口文件</li></ol><div class="language-js"><pre><code><span class="token keyword">const</span> debug <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;debug&#39;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">&#39;my-application&#39;</span><span class="token punctuation">)</span>\napp<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>\n    <span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&#39;服务器运行在80端口上&#39;</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre></div><ol start="4"><li>修改package.json的script运行脚本</li></ol><div class="language-json"><pre><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nodemon ./index.js&quot;</span>\n<span class="token punctuation">}</span>\n</code></pre></div><p>之后就可以直接npm start启动服务了</p><p>nodemon支持指定监听文件</p><div class="language-js"><pre><code>nodemon <span class="token operator">--</span>watch <span class="token string">&#39;src/**/*.ts&#39;</span> <span class="token operator">--</span>ignore <span class="token string">&#39;src/**/*.spec.ts&#39;</span> <span class="token operator">--</span>exec <span class="token string">&#39;ts-node&#39;</span> src<span class="token operator">/</span>index<span class="token punctuation">.</span>ts\n</code></pre></div><h2 id="八、使用脚手架快速生成express框架"><a class="header-anchor" href="#八、使用脚手架快速生成express框架" aria-hidden="true">#</a> 八、使用脚手架快速生成express框架</h2><blockquote><p>官网：<a href="https://github.com/expressjs/generator" target="_blank" rel="noopener noreferrer">https://github.com/expressjs/generator</a></p></blockquote><ol><li><p>安装：<code>npm install express-generator -g</code></p></li><li><p>生成jade项目：<code>express projectName</code></p><p>默认是<code>jade</code>模板</p><p>生成项目之后需要进入运行<code>npm i</code>安装依赖;</p><p>启动项目默认端口是3000；</p></li><li><p>使用ejs模板项目：<code>express projectName -e</code></p><p>-e表示使用ejs模板;</p></li></ol><h2 id="九、javascript运行机制"><a class="header-anchor" href="#九、javascript运行机制" aria-hidden="true">#</a> 九、javascript运行机制</h2><p>javascript是单线程的</p><p>主要用途是与用户交互，操作dom，因此只能是单线程，</p><p>所有同步任务都会放到栈中，回调函数都会放在任务对列，只有执行栈全部清空才会执行任务队列，回调函数比如定时器。</p><p>setTimout的最小时间是4ms，低于4毫秒自动设为4ms。</p><p>nodejs的</p><p>process.nextTick(不推荐使用)和setImmediate的值是一个回调函数。</p><p>process.nextTick 方法可以在当前&quot;执行栈&quot;的尾部之前执行。比settimeout先执行，</p><p>setImmediate方法则是在当前&quot;任务队列&quot;的尾部添加事件，它指定的任务总是注册到下一次Event Loop时执行，同一轮的event先执行，如同setTimeout(func, 0)</p><p>多个process.nextTick语句总是在当前&quot;执行栈&quot;一次执行完，多个setImmediate可能则需要多次loop才能执行完。</p><div class="language-js"><pre><code>process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre></div><p>将会一直循环递归，不会去执行其他的代码</p>',70);t.render=function(a,p,t,e,c,l){return n(),s("div",null,[o])};export default t;export{p as __pageData};
